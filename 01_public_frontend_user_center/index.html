<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>成绩管理教学平台</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <nav class="global-nav">
        <div class="nav-content">
            <a href="#" class="nav-logo" onclick="app.renderHome()">成绩管理教学平台</a>
            <div class="nav-links" id="navLinks">
                <a href="#" onclick="app.renderHome()">首页</a>
                <a href="#" onclick="app.showLoginModal()" id="loginBtn">登录</a>
            </div>
        </div>
    </nav>

    <div id="app" class="main-container"></div>

    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="app.hideLoginModal()">&times;</span>
            <h2 class="card-title" style="text-align: center; margin-bottom: 20px;">账户登录</h2>
            <form id="loginForm" onsubmit="app.handleLogin(event)">
                <div class="form-group">
                    <label class="form-label">用户ID / 学号 / 工号</label>
                    <input type="text" class="form-input" id="username" required placeholder="请输入账号">
                </div>
                <div class="form-group">
                    <label class="form-label">密码</label>
                    <input type="password" class="form-input" id="password" required placeholder="请输入密码">
                </div>
                <div class="form-group">
                    <button type="submit" class="btn btn-primary" style="width: 100%;">登录</button>
                </div>
                <div style="text-align: center; font-size: 12px; color: #86868b;">
                    <a href="#" onclick="app.showForgotPasswordModal()" style="color: #0066cc; text-decoration: none; margin-right: 15px;">忘记密码？</a>
                    <a href="#" onclick="app.showRegisterModal()" style="color: #0066cc; text-decoration: none;">注册新账号</a>
                </div>
            </form>
        </div>
    </div>

    <div id="registerModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="app.hideRegisterModal()">&times;</span>
            <h2 class="card-title" style="text-align: center; margin-bottom: 20px;">新用户注册</h2>
            <form id="registerForm" onsubmit="app.handleRegister(event)">
                <div class="form-group">
                    <label class="form-label">账号ID (学号/工号)</label>
                    <input type="text" class="form-input" id="regId" required placeholder="请输入账号ID (如 S001)">
                </div>
                <div class="form-group">
                    <label class="form-label">姓名</label>
                    <input type="text" class="form-input" id="regName" required placeholder="请输入真实姓名">
                </div>
                <div class="form-group">
                    <label class="form-label">邮箱 (用于找回密码)</label>
                    <input type="email" class="form-input" id="regEmail" required placeholder="请输入邮箱">
                </div>
                <div class="form-group">
                    <label class="form-label">角色</label>
                    <select class="form-input" id="regRole">
                        <option value="student">学生</option>
                        <option value="teacher">教师</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">设置密码</label>
                    <input type="password" class="form-input" id="regPassword" required placeholder="请输入密码 (至少6位)">
                </div>
                <div class="form-group">
                    <label class="form-label">确认密码</label>
                    <input type="password" class="form-input" id="regConfirmPassword" required placeholder="请再次输入密码">
                </div>
                <div class="form-group">
                    <button type="submit" class="btn btn-primary" style="width: 100%;">注册</button>
                </div>
                <div style="text-align: center; font-size: 12px;">
                    <a href="#" onclick="app.showLoginModal()" style="color: #0066cc; text-decoration: none;">已有账号？直接登录</a>
                </div>
            </form>
        </div>
    </div>

    <div id="forgotPasswordModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="app.hideForgotPasswordModal()">&times;</span>
            <h2 class="card-title" style="text-align: center; margin-bottom: 20px;">重置密码</h2>
            <form id="forgotPasswordForm" onsubmit="app.handleForgotPassword(event)">
                <div class="form-group" id="fpStep1">
                    <label class="form-label">账号 (学号/工号)</label>
                    <input type="text" class="form-input" id="fpUsername" required placeholder="请输入账号">
                    <button type="button" class="btn btn-primary" onclick="app.verifyUserAndSendCode()" style="width: 100%; margin-top: 15px;">验证并发送验证码</button>
                </div>
                
                <div id="fpStep2" style="display: none;">
                    <div class="form-group">
                        <label class="form-label">验证码</label>
                        <input type="text" class="form-input" id="fpCode" placeholder="请输入收到的验证码">
                    </div>
                    <div class="form-group">
                        <label class="form-label">新密码</label>
                        <input type="password" class="form-input" id="fpNewPassword" placeholder="请输入新密码">
                    </div>
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary" style="width: 100%;">重置密码</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <div id="changePasswordModal" class="modal">
        <div class="modal-content">
            <h2 class="card-title" style="text-align: center; margin-bottom: 20px;">首次登录需修改密码</h2>
            <p style="color: #666; font-size: 14px; margin-bottom: 20px;">为了您的账户安全，请设置一个新的密码。</p>
            <form id="changePasswordForm" onsubmit="app.handleChangePassword(event)">
                <div class="form-group">
                    <label class="form-label">新密码</label>
                    <input type="password" class="form-input" id="cpNewPassword" required placeholder="请输入新密码">
                </div>
                <div class="form-group">
                    <label class="form-label">确认新密码</label>
                    <input type="password" class="form-input" id="cpConfirmPassword" required placeholder="请再次输入新密码">
                </div>
                <div class="form-group">
                    <button type="submit" class="btn btn-primary" style="width: 100%;">确认修改</button>
                </div>
            </form>
        </div>
    </div>

    <div id="userChangePasswordModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="app.hideUserChangePasswordModal()">&times;</span>
            <h2 class="card-title" style="text-align: center; margin-bottom: 20px;">修改密码</h2>
            <form id="userChangePasswordForm" onsubmit="app.handleUserChangePassword(event)">
                <div class="form-group">
                    <label class="form-label">新密码</label>
                    <input type="password" class="form-input" id="ucpNewPassword" required placeholder="请输入新密码">
                </div>
                <div class="form-group">
                    <label class="form-label">确认新密码</label>
                    <input type="password" class="form-input" id="ucpConfirmPassword" required placeholder="请再次输入新密码">
                </div>
                <div class="form-group">
                    <button type="submit" class="btn btn-primary" style="width: 100%;">确认修改</button>
                </div>
            </form>
        </div>
    </div>

    <div id="toast" class="toast">操作成功</div>

    <script src="./js/data.js"></script>
    <script src="./js/public.js"></script>
    <script src="../02_student/js/student.js"></script>
    <script src="../03_teacher/js/teacher.js"></script>
    <script src="../04_edu_admin/js/edu_admin.js"></script>
    <script src="../05_sys_admin/js/sys_admin.js"></script>
</body>
</html>

