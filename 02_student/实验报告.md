# 成绩管理教学平台（GradeSystem）实验报告

## 一、系统整体分析与设计

### 1. 概述（整体思路）
本项目采用“纯前端 + 本地持久化”的实现思路：以 `01_public_frontend_user_center/index.html` 作为单页入口，通过 `app` 对象统一管理登录状态、页面渲染与角色分流；以 `DB` 对象封装 `localStorage` 的读写，模拟后端数据库与鉴权逻辑；不同角色（学生/教师/教学管理员/系统管理员）以独立脚本文件扩展 `app`（`Object.assign(app, {...})`），实现各自工作台与业务功能。整体实现上遵循“先鉴权、后分流、再渲染”的流程：启动时读取 `currentUser`，若已登录则进入控制台并根据 `role` 进入对应模块，否则展示公共首页并提供登录入口。数据层在首次运行时注入 Mock 数据，并支持后续增量维护与持久化，使系统无需后端即可完成课程展示、选课、成绩录入与查询等核心链路。

### 2. 网站整体结构功能图（1图）
```mermaid
flowchart TB
  A[入口: 01_public_frontend_user_center/index.html] --> B[全局样式: css/style.css]
  A --> C[数据层: DB + MockData\n01_public_frontend_user_center/js/data.js]
  A --> D[应用层: app 状态/渲染/登录\n01_public_frontend_user_center/js/public.js]

  D --> E{角色分流\napp.renderDashboard()}
  E --> S[学生端\n02_student/js/student.js]
  E --> T[教师端\n03_teacher/js/teacher.js]
  E --> EA[教学管理员\n04_edu_admin/js/edu_admin.js]
  E --> SA[系统管理员\n05_sys_admin/js/sys_admin.js]

  S <--> C
  T <--> C
  EA <--> C
  SA <--> C
```

### 3. 主要功能作用与特色（每个功能最多1图 + 500字以内说明）

#### 3.1 公共模块：首页展示 / 课程搜索 / 登录
<img src="./report_images/home.png" width="45%" />

公共模块提供统一入口与低门槛浏览体验：游客可在首页查看已发布课程（按 `status === 'published'` 过滤），并支持输入关键字实时筛选（课程名/课程号/学院）。登录采用前端模拟鉴权：`DB.login()` 基于用户表校验密码，并加入“连续 3 次失败锁定 5 分钟”的安全策略；同时支持将旧的弱哈希方案迁移为 WebCrypto PBKDF2（兼容存量数据并提升安全性）。登录成功后，导航栏实时切换为“控制台/退出登录”，并使用 Toast 提示登录状态变化。

#### 3.2 学生端：选课与成绩查询
<img src="./report_images/student.png" width="45%" />

学生端以工作台为核心入口，提供“我的课程 / 选课中心 / 成绩单”三类能力：在“选课中心”浏览全部已发布课程并完成选课；在“我的课程”查看本人已选课程与学习状态；在“成绩单”查看总评与各分项成绩。选课写入 `enrollments` 表并持久化到 `localStorage`，界面会根据是否已选课动态禁用按钮，避免重复选课带来的数据异常。

#### 3.3 教师端：课程发布与成绩录入
<img src="./report_images/teacher.png" width="45%" />

教师端支持发布与维护课程，并对选课名单进行成绩录入：教师可创建课程（课程号、学分、时间地点、简介等），课程立即进入“已发布”状态供学生选修；在成绩录入界面按学生逐条填写平时/期中/期末分数，系统按 30%/30%/40% 自动计算总评并保存到 `enrollments`。同时将关键操作写入 `logs`，便于系统管理员审计。

#### 3.4 教学管理员：学生管理与教务入口
<img src="./report_images/edu_admin.png" width="45%" />

教学管理员侧重基础数据维护：提供学生列表展示、删除入口，以及批量导入（模拟）能力；同时预留排课管理入口，体现教务系统“数据维护 + 业务入口”两层结构。该模块与其它角色共用同一份 `DB` 数据层，保证用户、课程、选课等数据的一致性。

#### 3.5 系统管理员：审计日志与数据维护
<img src="./report_images/sys_admin.png" width="45%" />

系统管理员主要承担审计与维护职责：查看系统关键操作日志（创建课程、备份等），用于问题追踪与责任归因；并提供“立即备份/恢复（模拟）”等运维入口，体现管理后台常见的“审计 + 维护”功能组合。由于系统以 `localStorage` 持久化为主，备份功能以交互模拟呈现，重点在流程与界面交互设计。

### 4. 团队分工与工作量占比评估（结合整体结构图）
结合结构图，系统可以按“公共基础层 + 四类角色业务层”进行模块化分工。建议的分工与工作量占比如下（以 100% 估算）：

| 成员/模块 | 负责内容 | 主要产出 | 工作量占比 |
| --- | --- | --- | --- |
| 成员A：公共模块 | 首页、登录、导航、Toast、角色分流 | `index.html` + `public.js` | 25% |
| 成员B：学生端 | 选课、我的课程、成绩单 | `02_student/js/student.js` | 20% |
| 成员C：教师端 | 课程发布/编辑、成绩录入、日志写入 | `03_teacher/js/teacher.js` | 25% |
| 成员D：教学管理员 | 学生管理、导入模拟、教务入口 | `04_edu_admin/js/edu_admin.js` | 15% |
| 成员E：系统管理员 | 日志审计、数据维护入口 | `05_sys_admin/js/sys_admin.js` | 15% |

其中公共模块与教师端占比较高，原因是它们承担了全局状态管理/鉴权与更复杂的 CRUD 交互；学生端核心链路完整、交互密集，工作量居中。

## 二、个人实现部分说明（重点：教师端）

### 1. 概述（个人实现部分的选择与范围，500字以内）
本人负责教师端模块（`03_teacher/js/teacher.js`），主要原因是教师端处于业务链路的关键节点：既要提供课程发布与维护能力，又要完成面向选课名单的成绩录入，从而驱动学生端查询与系统审计。教师侧的核心目标是“低成本维护课程、快速录入成绩并减少错误”：在信息架构上以“课程列表”为入口聚合管理与录入能力；在交互上提供表格化录入、即时计算总评与单行保存；在数据上将关键操作同步写入日志，便于系统管理员审计与追溯。

### 2. 分析设计与实现效果

#### 2.1 需求分析（从问题到要点）
根据系统数据模型（`users/courses/enrollments/logs`），教师侧的关键任务可归纳为：

1) 能查看“我教授的课程”清单，并看到状态与选课人数。  
2) 能发布新课程并立即对学生可见（写入 `courses` 并持久化）。  
3) 能维护课程信息（课程简介、时间、教室等）。  
4) 能对选课名单录入平时/期中/期末分数，并自动计算总评。  
5) 能将关键操作写入 `logs`，便于审计。  

#### 2.2 设计实现（界面结构 + 数据流）
教师端采用“工作台 + 内容区”结构：页面固定渲染教师工作台标题，内容区默认展示课程列表（`renderTeacherDashboard()` -> `getTeacherCourseListHTML()`），并通过按钮在“课程发布/编辑/成绩录入”等子页面之间切换。数据流统一从 `DB.get()` 获取，并通过当前登录用户 `app.state.currentUser.id` 过滤教师课程与关联选课记录：

- 课程列表：筛选 `courses(teacherId)`，并统计每门课的选课人数（遍历 `enrollments(courseId)`）。  
- 发布课程：表单提交生成 `newCourse` 写入 `courses` 并 `DB.set()`；同时写入 `logs` 记录创建行为。  
- 编辑课程：按 `courseId` 找到课程，更新简介/时间/教室字段并持久化。  
- 成绩录入：按 `courseId` 获取选课记录与学生信息，表格化输入分项分数；每次输入触发总评计算（30%/30%/40%），单行保存写回 `enrollments`。  

对应实现位置：
- 工作台入口：`03_teacher/js/teacher.js:2`  
- 课程列表：`03_teacher/js/teacher.js:12`  
- 成绩录入：`03_teacher/js/teacher.js:45`  
- 总评计算：`03_teacher/js/teacher.js:78`  
- 单行保存：`03_teacher/js/teacher.js:86`  
- 发布课程：`03_teacher/js/teacher.js:102`  
- 课程编辑：`03_teacher/js/teacher.js:171`  

#### 2.3 实现效果（小图展示）
教师工作台与核心功能页面示例如下：

<img src="./report_images/teacher-dashboard.png" width="33%" />
<img src="./report_images/teacher-create-course.png" width="33%" />
<img src="./report_images/teacher-grade-entry.png" width="33%" />

### 3. 网站特色、新意说明（个人实现部分，至少1点）

1) 表格化录入 + 即时总评计算，降低人工误差  
成绩录入界面以选课名单为表格载体，分项分数变更时即时计算总评并展示（`03_teacher/js/teacher.js:78-84`），教师可在确认后单行保存，减少“先算后填/抄错”的概率，同时支持逐个学生渐进式保存，避免一次性提交失败造成的重复劳动。

2) 课程管理入口聚合，减少跳转成本  
教师端以“我教授的课程”作为唯一入口聚合“录入成绩/管理课程/发布课程”（`03_teacher/js/teacher.js:12-43`），将高频动作放在同一列表的操作列中，符合教师从课程维度进行工作的习惯。

3) 关键操作写日志，增强可追溯性  
在发布新课程时同步写入 `logs`（`03_teacher/js/teacher.js:158-166`），使系统管理员可在审计模块中回溯关键动作。该设计将“业务动作”和“审计记录”保持一致来源，便于后续扩展更多操作类型。

## 三、总结

### 1. 完成情况自评
系统已实现游客浏览、登录鉴权、多角色工作台、选课与成绩链路等核心功能，界面风格统一、交互连贯。教师端覆盖“课程发布/维护—成绩录入—日志记录”的关键流程，并以表格化录入与即时计算减少录入成本。由于采用纯前端本地存储，功能更偏演示与原型验证，真实生产环境仍需服务端、权限与数据校验等补齐。

### 2. 复盘（做得最好的3点 vs 最不好的3点）
做得最好的：
1) 入口聚合清晰：课程列表聚合管理/录入/发布入口。  
2) 录入效率高：表格化输入 + 即时总评计算 + 单行保存。  
3) 审计意识到位：关键动作写入 `logs`，可追溯。  

做得最不好的：
1) 模块耦合偏高：通过全局 `app` 扩展，缺少更明确的模块边界。  
2) 缺少业务规则校验：如课程号唯一性、成绩范围约束、发布/撤回流程等未完善。  
3) 缺少可测试性：以 DOM 字符串拼接为主，单元测试与可维护性一般。  

### 3. 重复（未来参与类似网站，我会如何做）
若以正式前端岗位实现类似系统，我会优先把需求与权限模型梳理清楚（角色、资源、操作），并把“数据层/权限层/页面层”分层设计：后端提供标准化 API 与鉴权（JWT/Session）、前端采用组件化框架或模块化方案以提升复用与可测试性；关键业务（选课规则、成绩发布、审计）在服务端进行强校验，前端负责呈现与交互优化；同时建立自动化测试（单元 + 端到端）与 CI 流程，保证迭代过程中质量可控、回归成本低。

